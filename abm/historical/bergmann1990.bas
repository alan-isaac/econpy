  0 REM See bergmann1990.txt for documentation.

 10 DEFINT I-N
 20 REM open "results.vi" FOR OUTPUT AS #1
 30 DIM IEMPST(1000), IDATE(1000), NEMP(70), ELIG(1000)
 
 40 FOR IWEEK= 1 TO 19 : NEMP(IWEEK) = 950 : NEXT
 45 FOR IWEEK = 20 TO 29 : NEMP(IWEEK) = NEMP(IWEEK - 1) - 5 : NEXT
 50 FOR IWEEK = 30 TO 40 : NEMP(IWEEK) = 895 : NEXT
 57 FOR IWEEK = 41 TO 50 : NEMP(IWEEK) = NEMP(IWEEK- 1) + 5 : NEXT
 60 FOR IWEEK = 51 TO 70 : NEMP(IWEEK) = 950 : NEXT
 70 LABFOR= 1000 : RATLV= .015
 80 UN= LABFOR - NEMP(1)

 90 FOR IPERS= 1 TO NEMP(1)
100 IEMPST(IPERS) = 1 : ELIG(lPERS) = 6
102 NEXT IPERS
104 FOR IPERS = NEMP(1) + 1 TO LABFOR
110 IEMPST(IPERS) =0
111 IDAT = IDAT + 1 : IF IDAT>4 THEN IDAT = 0
112 IDATE(IPERS) = (-1)*IDAT
115 EL = EL + 1 : IF EL>6 THEN EL = 0
117 ELIG(IPERS)=EL
120 NEXT IPERS

130 FOR IWEEK = 2 TO 70

140 LEAVS= RATLV*(LABFOR - UN)
150 DIFEMP = NEMP(IWEEK) - NEMP(IWEEK - 1)
160 IF DIFEMP <O THEN ISEP = LEAVS - DIFEMP ELSE ISEP = LEAVS
170 FOR K= 1 TO ISEP
180 ICHOSE = RND*LABFOR + .5
190 IF IEMPST(ICHOSE)=O THEN GOTO 180
200 IEMPST(ICHOSE)= 0
210 IDATE(ICHOSE)=IWEEK
220 NEXT K

230 IF DIFEMP>O THEN IHIR = LEAVS + DIFEMP ELSE IHIR = LEAVS
231 IHIR = IHIR + VAC
240 FOR L = 1 TO IHIR
241 NFAIL=O
250 ICHOSE= RND*LABFOR + .5
260 IF IEMPST(ICHOSE)=1 THEN GOTO 250
265 IF IDATE(ICHOSE)=IWEEK THEN GOTO 267
266 IF ELIG(ICHOSE)<2 THEN GOTO 270
267 NFAIL = NFAIL + 1
268 IF NFAIL<10 THEN GOTO 250 ELSE GOTO 290
270 IEMPST(ICHOSE)=1
290 NEXT L

300 UN= 0 : TIMSUM = 0
310 FOR IPERS= 1 TO LABFOR
311 IF IEMPST(IPERS) = 1 THEN ELIG(IPERS) = ELIG(IPERS) + 1 / 3
312 IF IEMPST(IPERS) = 0 THEN ELIG(IPERS) = ELIG(IPERS) - 1
313 IF ELIG(IPERS)>6 THEN ELIG(IPERS)=6
314 IF ELIG(IPERS)<O THEN ELIG(IPERS)=O
320 IF IEMPST(IPERS)<>O GOTO 370
330 UN= UN+ 1
340 UTIM = IWEEK- IDATE(IPERS)
350 PRINT IPERS ``1'' UTIM `` '';
360 TIMSUM = TIMSUM + UTIM
370 NEXT IPERS
372 VAC = NEMP(IWEEK) - (LABFOR- UN)
380 UTIMAV = TIMSUM / UN
390 UR= UN / LABFOR
400 PRINT "simulated macro variables", IWEEK, UR, UTIMAV
405 REM PRINT #1, "simulated macro variables", IWEEK, UR, UTIMAV

410 NEXT IWEEK

420 END

